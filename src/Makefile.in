LD = $(CXX)

ROSEROOT = @ROSE_DIR@
XEROOT = @XERCESC_DIR@
XAROOT = @XALANC_DIR@
CXXFLAGS= -g -Wall -Wno-deprecated -I../include
CXXFLAGS += -I../include @ROSE_CFLAGS@ @XALANC_CFLAGS@ @XERCESC_CFLAGS@
LIBS  += @ROSE_LIBS@ @XALANC_LIBS@ @XERCESC_LIBS@

SRCS    =  xmlutils.cpp type.cpp rose2xml.cpp xml2rose.cpp \
	preproc.cpp unparse.cpp expr.cpp stmt.cpp decl.cpp supp.cpp value.cpp
OBJS = ${SRCS:.cpp=.o}
DEPS = ${SRCS:.cpp=.d}

TARGET = src2xml xsltexec xml2src dir2xml

.SUFFIXES: .cpp .o

all : $(TARGET)

src2xml: $(OBJS) src2xml.o
	$(LD) $(OBJS) src2xml.o -o $@ $(LIBS)

xsltexec: $(OBJS) xslt.o
	$(LD) $(OBJS) xslt.o -o $@ $(LIBS)

xml2src: $(OBJS) xml2src.o
	$(LD) $(OBJS) xml2src.o -o $@ $(LIBS)

dir2xml: $(OBJS) dir2xml.o
	$(LD) $(OBJS) dir2xml.o -o $@ $(LIBS)

.cpp.o:
	$(CXX) $(CXXFLAGS) -o $@ -c $^

-include $(DEPS)

clean:
	-@rm -fr *~ $(OBJS) src2xml.o xslt.o xml2src.o dir2xml.o $(DEPS) $(TARGET) rose_* a.out

